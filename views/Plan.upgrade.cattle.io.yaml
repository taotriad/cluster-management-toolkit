---
kind: "Plan"
api_family: "upgrade.cattle.io"
default_command: "plans"
listview:
  name: "Plans"
  group: "Rancher"
  field_indexes:
    Wide:
      fields: ["namespace", "name", "image", "channel",
               "version", "latest_version", "age"]
      sortcolumn: "namespace"
    Normal:
      fields: ["namespace", "name", "image",
               "version", "latest_version", "age"]
      sortcolumn: "namespace"
  fields:
    channel:
      header: "Channel:"
      path: "spec#channel"
      type: "str"
      default: "<unset>"
      formatting:
        field_colors:
          - type: "version"
    image:
      header: "Image:"
      path: "spec#upgrade#image"
      type: "str"
    latest_version:
      header: "Latest Version:"
      path: "status#latestVersion"
      type: "str"
      default: "<unset>"
      formatting:
        field_colors:
          - type: "version"
    version:
      header: "Version:"
      path: "spec#version"
      type: "str"
      default: "<unset>"
      formatting:
        field_colors:
          - type: "version"
infoview:
  name: "Plan Info"
  infopad:
    row_indexes:
      Normal:
        fields: ["service_account", "prepare", "upgrade", "cordon",
                 "drain_header", "drain_delete_local_data",
                 "drain_ignore_daemon_sets", "drain_force",
                 "drain_disable_eviction",
                 "drain_skip_wait_for_delete_timeout", "channel",
                 "version", "latest_version",
                 "node_label_selector",
                 "node_set_based_selector",
                 "concurrency"]
    rows:
      channel:
        header: [["Channel:", ["main", "infoheader"]]]
        path: "spec#channel"
        type: "str"
        default: "<unset>"
        formatting:
          field_colors:
            - type: "version"
      concurrency:
        header: [["Concurrency:", ["main", "infoheader"]]]
        path: "spec#concurrency"
        default: "<unset>"
        type: "str"
        formatter: "numerical"
      cordon:
        header: [["Cordon:", ["main", "infoheader"]]]
        path: "spec#cordon"
        type: "bool"
        default: "<unset>"
      drain_header:
        header: [["Drain:", ["main", "infoheader"]]]
      drain_delete_local_data:
        header: [["  Delete Local Data:", ["main", "infoheader"]]]
        path: "spec#drain#deleteLocalData"
        default: "<unset>"
        type: "bool"
      drain_disable_eviction:
        header: [["  Disable Eviction:", ["main", "infoheader"]]]
        path: "spec#drain#disableEviction"
        default: "<unset>"
        type: "bool"
      drain_force:
        header: [["  Force:", ["main", "infoheader"]]]
        path: "spec#drain#force"
        default: "<unset>"
        type: "bool"
      drain_ignore_daemon_sets:
        header: [["  Ignore Daemon Sets:", ["main", "infoheader"]]]
        path: "spec#drain#ignoreDaemonSets"
        default: "<unset>"
        type: "bool"
      drain_skip_wait_for_delete_timeout:
        header: [["  Skip Wait for Delete Timeout:", ["main", "infoheader"]]]
        path: "spec#drain#skipWaitForDeleteTimeout"
        default: "<unset>"
        type: "numerical"
        formatter: "numerical"
      node_label_selector:
        header: [["Node La", ["main", "infoheader"]],
                 ["b", ["main", "infoheader_shortcut"]],
                 ["el Selector:", ["main", "infoheader"]]]
        paths:
          - path: ["spec#nodeSelector#matchLabels"]
            pathtype: "key_value"
            default: ["<none>"]
        formatter: "list"
        formatting:
          field_colors:
            - type: "key"
            - type: "value"
          field_separators:
            - type: "selector"
      latest_version:
        header: [["Latest Version:", ["main", "infoheader"]]]
        path: "status#latestVersion"
        type: "str"
        default: "<unset>"
        formatting:
          field_colors:
            - type: "version"
      node_set_based_selector:
        header: [["Node Set-based Selector:", ["main", "infoheader"]]]
        paths:
          - path: "spec#nodeSelector#matchExpressions"
            pathtype: "match_expression"
            default: "<none>"
        formatter: "list"
        formatting:
          field_colors:
            - type: "key"
            - type: "operator"
            - type: "value"
          field_separators:
            - type: "space"
            - type: "no_pad"
      prepare:
        header: [["P", ["main", "infoheader_shortcut"]],
                 ["repare:", ["main", "infoheader"]]]
        paths:
          - path: "spec#prepare#image"
            pathtype: "regex"
            regex: "^([^:]+):(.*)|^(.+)"
            default: ["<none>"]
        formatter: "list"
        formatting:
          field_colors:
            - type: "generic"
            - type: "version"
          field_separators:
            - type: "version"
      service_account:
        header: [["S", ["main", "infoheader_shortcut"]],
                 ["ervice Account:", ["main", "infoheader"]]]
        path: "spec#serviceAccountName"
        type: "str"
      upgrade:
        header: [["U", ["main", "infoheader_shortcut"]],
                 ["pgrade:", ["main", "infoheader"]]]
        paths:
          - path: "spec#upgrade#image"
            pathtype: "regex"
            regex: "^([^:]+):(.*)|^(.+)"
            default: ["<none>"]
        formatter: "list"
        formatting:
          field_colors:
            - type: "generic"
            - type: "version"
          field_separators:
            - type: "version"
      version:
        header: [["Version:", ["main", "infoheader"]]]
        path: "spec#version"
        type: "str"
        default: "<unset>"
        formatting:
          field_colors:
            - type: "version"
  shortcuts:
    "Node Label Selector":
      key: "b"
      read_only: true
      helptext: "Show node label selector"
      widget: "windowwidget"
      title: "Node Label Selector:"
      headers: ["Key:", "Value:"]
      itemgetter: "get_key_value"
      itemgetter_args:
        path: "spec#nodeSelector#matchLabels"
    "Secrets":
      key: "s"
      read_only: true
      helptext: "List Secrets"
      widget: "windowwidget"
      title: "Secrets:"
      selectable: true
      headers: ["Name:", "Path:"]
      itemgetter: "get_list_fields"
      itemgetter_args:
        path: "spec#secrets"
        fields:
          - "name"
          - "path"
      # This isn't supported for now
      sortcolumn: "name"
      action: "call"
      action_call: "resourceinfodispatch_with_lookup"
      action_args:
        _pass_obj: true
        _pass_selected: true
        kind: "Secret"
        name_path: 0
        namespace_path: "metadata#namespace"
    "Service Account":
      key: "s"
      modifier: "shift"
      read_only: true
      helptext: "Open info page for Service Account"
      action: "call"
      action_call: "resourceinfodispatch_with_lookup"
      action_args:
        _pass_obj: true
        kind: "ServiceAccount"
        name_path: "spec#serviceAccountName"
        namespace_path: "metadata#namespace"
    "Show Preparation":
      key: "p"
      modifier: "shift"
      read_only: true
      helptext: "Show preparation configuration"
      action: "call"
      action_call: "view_yaml"
      action_args:
        title: "Preparation Configuration"
        _pass_obj: true
        path: "spec#prepare"
        include_root: true
    "Show Upgrade":
      key: "u"
      modifier: "shift"
      read_only: true
      helptext: "Show upgrade configuration"
      action: "call"
      action_call: "view_yaml"
      action_args:
        title: "Upgrade Configuration"
        _pass_obj: true
        path: "spec#upgrade"
        include_root: true
    "Show tolerations":
      key: "t"
      read_only: true
      helptext: "Show tolerations"
      widget: "windowwidget"
      headers: ["Key:", "Operator:", "Value:", "Effect:", "Timeout:"]
      itemgetter: "get_pod_tolerations"
      # This isn't supported for now
      sortcolumn: "key"
